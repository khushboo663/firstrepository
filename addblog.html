<!DOCTYPE html>
<html>
<head>
    <script src="js/includehtml.js"></script> 
    <script src="js/onload.js">  </script>

        <div w3-include-html="snippets/content.html"></div> 
        <style>
            .vl {
              border-left: 1px solid;
              height: 800px;
            }
            </style>
    
</head>
    <body>
       <div class="tm-header" >
            <div class="container-fluid">
                <div class="tm-header-inner">

                </div>                                  
            </div>            
        </div>

        
        <section >
            <div>
                <div class="row" style="padding-top: 0px;padding-bottom: 0px;">

                 <!-- include previousblogs.html file here -->
                  <div w3-include-html="snippets/previousblogs.html"></div>

                     <aside class="col-xs-12 col-sm-12 col-md-4 col-lg-3 col-xl-3 tm-aside-r vl">
                        
                    <br/>
                    <br/>
                    <br/>
                    
                        <div class="tm-aside-container">
                            <h3 class="tm-gold-text tm-title">
                                Write New Blog:
                            </h3>
                            
                            <nav>
                                <ul class="nav">
                                   <li><h4 class="tm-margin-b-20 tm-gold-text">Title:</h4></li>
                                    <li> <input type="text" maxlength="50" name="titlecontent" placeholder="Enter Title for Blog" id="titletxt" style=" padding: 15px"></li>
                                    <li><h4 class="tm-margin-b-20 tm-gold-text">Blog:</h4></li>
                                    <li> <textarea name="blogcontent" id="blogtxt" cols="20" rows="6" placeholder="Enter Content of Blog" style=" padding: 15px"></textarea></li>
                                    <li><h4 class="tm-margin-b-20 tm-gold-text">Add Image:</h4></li>
                                    <li> <input type="file" name="imagecontent" id="imagetxt" onchange="storeimage(event)" accept="image/*"></li>
                              </ul>
                            </nav>
                            <hr class="tm-margin-t-small">  

                            <!---must include onload.js here-->

                             <script type="text/javascript">
                            var imageurl = "";
                            var imagesource;
                            var reader = new FileReader();
                            var locallength = localStorage.length/3 + 1;

                            function storeimage(event) {
                            
                                reader.onload = function()
                                {   
                              localStorage.setItem("imagesource" + locallength,JSON.stringify(reader.result));
                    }
                                if (event.target.files[0]) {
                                imageurl = reader.readAsDataURL(event.target.files[0]);
                              
    }
            
 }

                             
                                function  addblog() {
    
                               
                                // alert("localStorage.length/3 + 1 = " + locallength);

                                    var title = document.getElementById ("titletxt").value;
                                    var blog = document.getElementById ("blogtxt").value;
                                   
                                    if (title == "")
                                    {
                                        alert("Please Enter Title of Blog !!");
                                    }
                                    else if ( blog == "")
                                    {
                                        alert("Please Enter Content for Blog");
                                    }
                                    else if ( imageurl == "" || imageurl == "undefined")
                                    {
                                        alert("Please Enter Image for Blog");
                                    }
                                    else
                                    {
                                        if (typeof(Storage) == "undefined") {
                                        
                                        alert("local storage not accesible");
                                        } 
                                        else 
                                        {
                                        var list = document.getElementById ("presentblogs");
                                        var listItems = list.getElementsByTagName ("li");
                                        
                                     
                                        var headng = document.createElement("H4");
                                        localStorage.setItem("titletext" + locallength, title);
                                        
                                        var para = document.createElement("P");
                                       // var blogcont = blog.slice(0,150)+"...";
                                       localStorage.setItem("contenttext" + locallength, blog);

                                       // localStorage.setItem("contentfulltext" + locallength, blog);
                                       
                                        document.getElementById ("titletxt").value = "";
                                        document.getElementById ("blogtxt").value = "";
                                      
                               
                                    }
                                       
                                    }
                                    location. reload();
                                
                                }
                            </script>
                            
                            <input type="submit" value="Add Blog" class="tm-btn text-uppercase" id="addblogbtn" onclick="addblog()" style="align-content: center; margin: auto; display: flex; justify-content: center; ;">
                           
                           
                        </div>
                        
                        
                    </aside>

                </div>
                
            </div>
        </section>
    

        <!-- load JS files -->
        <script src="js/jquery-1.11.3.min.js"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="https://www.atlasestateagents.co.uk/javascript/tether.min.js"></script> <!-- Tether for Bootstrap, http://stackoverflow.com/questions/34567939/how-to-fix-the-error-error-bootstrap-tooltips-require-tether-http-github-h --> 
        <script src="js/bootstrap.min.js"></script>                 <!-- Bootstrap (http://v4-alpha.getbootstrap.com/) -->
        <script>includeHTML();</script>
        <script src="js/loadaddedblogs.js"></script>
        <script type="text/javascript">
        setTimeout(function()
        { 
         if (document.readyState == "complete")
         {
         loadaddedblogs();
        var pathname  = window.location.pathname;
        var listitemidentity = document.getElementById(pathname);
        listitemidentity.className = "nav-item active";
              listitemidentity.setAttribute("class","nav-item active");
               
         }
        }, 1000);
    </script>
</body>
</html>